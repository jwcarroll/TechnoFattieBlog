---
layout: post
title: Validating "Read the Source, Luke"
---

So recently Jeff Atwood <strike>quoted</strike> wrote a pretty nice article about why <a href="http://www.codinghorror.com/blog/2012/04/learn-to-read-the-source-luke.html">learning to read source code</a> is so important for developers. I absolutely could not agree more with that post.<br /><br />As a tribute, I thought I would share a recent example where this principle would have settled an argument on Stackoverflow, and perhaps not lead to me using two unwitting souls for fodder in this blog post.<br /><br />The question itself was pretty trivial. <i>"How to select List&lt;&gt; by its index and return the content?"</i><br /><br />One of the answers suggested using the&nbsp;<a href="http://msdn.microsoft.com/en-us/library/bb299233.aspx"><span style="background-color: #eeeeee; color: black; font-family: 'Courier New', Courier, monospace;">ElementAt</span> </a>extension method as an alternative to using the standard indexer. No big deal, but what ensued was a pretty fun little comment argument. I've changed the names to protect the innocent:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://1.bp.blogspot.com/-GcB6fbO4IAY/T5NwTwkDWAI/AAAAAAAABOE/S7OxWICZHTw/s1600/CommentThreadForStackoverflowQuestion_First.png" /></div><br />So Bob is making a legitimate claim that using <span style="background-color: #eeeeee;"><span style="font-family: 'Courier New', Courier, monospace;">ElementAt</span></span> would be&nbsp;inefficient&nbsp;compared to using an indexer. Unfortunately he also makes a pretty wild claim about <span style="background-color: #eeeeee;"><span style="font-family: 'Courier New', Courier, monospace;">ElementAt</span></span> not returning the same value that calling the indexer on a List<t> would.</t><br /><br />Larry then decides to defend himself in a way that every programmer has probably done at some point; he writes a small test program. You can see the code here:&nbsp;<a href="http://ideone.com/H0A2X">http://ideone.com/H0A2X</a><br /><br /><b>Despite the test program being fundamentally flawed</b>&nbsp;(<i>see fixed program here:&nbsp;<a href="http://ideone.com/hooQB">http://ideone.com/hooQB</a></i>), Larry got the numbers he was looking for. Armed with a helping of confirmation bias, and his new numbers, Larry decides to respond back to Bob.<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://2.bp.blogspot.com/-lU_RfC4YZfU/T5N0E0Uj-nI/AAAAAAAABOM/MlGgMQP4CNU/s1600/CommentThreadForStackoverflowQuestion_Second.png" /></div><br /><div class="separator" style="clear: both; text-align: left;">And what else did Larry have to say about his results:</div><div class="separator" style="clear: both; text-align: left;"></div><blockquote class="tr_bq"><span style="font-size: large;">"When it comes to errors, the MSDN documentation and a wealth of empirical evidence suggests that such concerns are wholly unfounded...&nbsp;<span style="background-color: yellow;">The&nbsp;<code style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; padding-top: 1px; vertical-align: baseline;">ElementAt()</code>&nbsp;method is definitely faster</span>...&nbsp;I have tested Lists of type double, float and string with similar results..."</span></blockquote>In the end... <b>both of these guys are wrong!</b><br /><br />So what is the truth? What does the source code say? Let's use <a href="http://www.jetbrains.com/decompiler/">DotPeek</a>&nbsp;and find out:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://2.bp.blogspot.com/-dhyxvPa-wkU/T5N6zmClg-I/AAAAAAAABOc/uEtsOcl4ZNM/s1600/ElementAtSource_Annotated.png" /></div><br />Turns out that <span style="background-color: #eeeeee; font-family: 'Courier New', Courier, monospace;">ElementAt</span> is optimized for anything that implements <span style="background-color: #eeeeee; font-family: 'Courier New', Courier, monospace;">IList&lt;T&gt;</span>and simply calls the indexer. <b>A 30 second look at the source code would have ended this argument before it started</b>. In reality <span style="background-color: #eeeeee; font-family: 'Courier New', Courier, monospace;">ElementAt</span> is 3 times slower when called on a <span style="background-color: #eeeeee; font-family: 'Courier New', Courier, monospace;">List&lt;T&gt;</span> because of the cast.<br /><br />If you need to know how something works, then you need to go to the source code and see for yourself. <b>Without this skill, you will never know for sure how stuff works.</b> Don't waste your time arguing about how you think things work when the answer is right at your finger tips.<br /><br />Follow <a href="http://www.codinghorror.com/">Jeff </a>and <a href="http://blog.brandonbloom.name/">Brandon's</a> advice and&nbsp;<a class="title-link" href="http://www.codinghorror.com/blog/2012/04/learn-to-read-the-source-luke.html">Learn to Read the Source, Luke</a><br /><br /><br /><br /><br /><br />
