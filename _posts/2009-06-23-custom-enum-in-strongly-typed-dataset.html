---
layout: post
title: Custom Enum in strongly typed DataSet
tags: [c#,.net,data-sets]
---

<div style="text-align: left;">Recently I found a question about <a href="http://stackoverflow.com/questions/1035796/enum-in-dataset">using Enums in a DataSet</a> on <a href="http://www.blogger.com/www.stackoverflow.com">StackOverflow</a>. I was a little dissapointed at the answers people provided that were either down right wrong, or overly complicated. Sometimes I think people are so hungry for reputation points they forget that they are supposed to be <i>answering</i> questions.</div><div style="text-align: center;"><br /></div><div>Anyway, one poster recommended using strongly typed DataSets, but then advocated partial classes, or modifying the generated code. While a strongly typed DataSet is the way to go, you don't have to do anything fancy to get enum support.</div><div><br /></div><div>Lets say we have just created a DataSet, and dropped a single DataTable into it:</div><div style="text-align: center;"><br /></div><img src="http://2.bp.blogspot.com/_zrLYGpcNAqw/SkGNLW-5LkI/AAAAAAAAArw/cSOTIk5daTo/s320/EnumDataSet.jpg" style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 186px; height: 75px;" border="0" alt="" id="BLOGGER_PHOTO_ID_5350713058580311618" /><div>Normally <b>AwesomeId</b> would just map to some integer key in a lookup table, and for whatever reason you have an enum that maps directly to this table in code:</div><div style="text-align: center;"><br /></div><div><pre name="code" class="c#">namespace&nbsp;StackOverflowExamples.Library.DataAccess.EnumDataSet<br />{<br /> public&nbsp;enum&nbsp;AwesomeEnum<br /> {<br />  Awesome,<br />  MoreAwesome,<br />  AwesomeIncarnate<br /> }<br />}</pre></div><div>What you want to avoid is having to cast this back and forth from an <b>Int</b> to an Enum. The nice folks at Microsoft were kind enough to give us a type property for each column in a DataSet that can be changed. If you select the column you want to map, and then navigate to the properties tab in Visual Studio, you will see that the column type is easily changeable.</div><div><br /></div><div><img src="http://4.bp.blogspot.com/_zrLYGpcNAqw/SkGRSbszr5I/AAAAAAAAAr4/KgYzIcV0YP8/s320/AwesomeIdColumn.jpg" style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" border="0" alt="" id="BLOGGER_PHOTO_ID_5350717578152226706" /></div><div>Now all you have to do is substitute the fully qualified Enum Type into that field and you are good to go.</div><div><br /></div><a href="http://picasaweb.google.com/lh/photo/ubIVvV3zxTXtfpTD2sr6cA?authkey=Gv1sRgCJeptOeUyKuEXA&amp;feat=embedwebsite"><img src="http://lh6.ggpht.com/_zrLYGpcNAqw/SkGS6iPG6vI/AAAAAAAAAsA/58dvcN0BomI/s800/AwesomeIdColumnDataTypeRenamed.jpg" style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" /></a><div>Are we there yet? Sort of. You could officially use this right now if you want, but chances are somehwere down the road you will eventually run into this gem (after a rebuild) when you attempt to open the designer.</div><div><span class="Apple-style-span"  style="color:#0000EE;"><span class="Apple-style-span" style=""><span class="Apple-style-span"  style="color:#000000;"><br /></span></span></span></div><div><a href="http://picasaweb.google.com/lh/photo/61HkPacV0Aqm0oTZzodxLA?authkey=Gv1sRgCJeptOeUyKuEXA&amp;feat=embedwebsite"><img src="http://lh5.ggpht.com/_zrLYGpcNAqw/SkGXrP7jCuI/AAAAAAAAAtE/ILJ7j9bzQPc/s800/WrongDataTypeError.jpg" style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;" /></a></div><div>In case this happens, don't worry you haven't permanently broken the designer, but you will have to manually edit the .xsd file. Navigate to your DataSet .xsd file and right click on it. Choose to open it up with the text editor of your choice, but you are better off just using the default Visual Studio text editor.</div><div><br /></div><div><a href="http://picasaweb.google.com/lh/photo/6mPamn5Km70Bn-79VWzoWw?authkey=Gv1sRgCJeptOeUyKuEXA&amp;feat=embedwebsite"><img src="http://lh6.ggpht.com/_zrLYGpcNAqw/SkGZq1h1DhI/AAAAAAAAAtI/-C4fknFOb2g/s800/xsdfile.jpg" /></a><br /></div><div><br /></div><div>Normally I don't advocate editing raw autogened XML, but this one is an easy fix. Find the line that maps your column name to a specific type. It should look something like this:</div><div><br /></div><div><pre name="code" class="xml">&lt;xs:element name=&quot;AwesomeId&quot; msdata:DataType=&quot;StackOverflowExamples.Library.DataAccess.EnumDataSet.AwesomeEnum, StackOverflowExamples.Library, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&quot; msprop:Generator_UserColumnName=&quot;AwesomeId&quot; msprop:Generator_ColumnPropNameInRow=&quot;AwesomeId&quot; msprop:Generator_ColumnVarNameInTable=&quot;columnAwesomeId&quot; msprop:Generator_ColumnPropNameInTable=&quot;AwesomeIdColumn&quot; type=&quot;xs:anyType&quot; minOccurs=&quot;0&quot; /&gt;</pre></div><div>Take a look at the <i>msdata:DataType</i> attribute. As you can clearly see, our fully qualified type is listed here, but there is some assembly information that is causing us problems. Simply remove everything after the <i>Type Name.</i></div><div><pre name="code" class="xml">&lt;xs:element name=&quot;AwesomeId&quot; msdata:DataType=&quot;StackOverflowExamples.Library.DataAccess.EnumDataSet.AwesomeEnum&quot; msprop:Generator_UserColumnName=&quot;AwesomeId&quot; msprop:Generator_ColumnPropNameInRow=&quot;AwesomeId&quot; msprop:Generator_ColumnVarNameInTable=&quot;columnAwesomeId&quot; msprop:Generator_ColumnPropNameInTable=&quot;AwesomeIdColumn&quot; type=&quot;xs:anyType&quot; minOccurs=&quot;0&quot; /&gt;</pre></div><div>Now you can save the .xsd file, close it, and reopen your DataSet in the designer without any more problems.</div><div><br /></div><div>Enjoy your strongly typed DataSet with custom Enum values :)</div>
